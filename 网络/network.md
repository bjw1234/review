# 网络相关内容复习
TCP/IP模型是互联网的基础，它是一系列网络协议的总称。
这些协议可以划分为四层：应用层、传输层、网络层和链路层。

* 链路层：负责封装和解封装 IP 报文，发送和接受 ARP/RARP 报文等。
* 网络层：负责路由以及把分组报文发送给目标网络或主机。
* 传输层：负责对报文进行分组和重组，并以 TCP 或 UDP 协议格式封装报文。
* 应用层：负责向用户提供应用程序，比如 HTTP、FTP、Telnet、DNS、SMTP 等。


## UDP
特点：
1.面向无连接
2.有单播，多播，广播的功能
3.UDP是面向报文的
4.不可靠
5.头部开销很小（八字节）

## TCP
特点：
1.面向连接
2.仅支持单播传输
3.面向字节流
4.可靠传输
5.提供拥塞控制
6.提供全双工通信

三次握手：
SYN     ->
ACK-SYN <-
ACK     ->

四次挥手：
FIN ->
ACK <-
FIN <-
ACK ->

拆包和粘包：
拆？稳定性，效率，缓冲区。 ---TCP段（TCP Segment）
粘？防止多次发送占用资源，多个数据合并为一个TCP段发送。

TCP Segment
Source Port  Destination Port
Squence Number（发送字节数） 
Acknowledgment Number（接收字节数）
FIN/SYN/PSH/URG  -- 标志位
...

滑动窗口+流速控制
是TCP协议控制可靠性的核心。


TCP/UDP 区别
1.目的性差异
2.可靠性
3.连接和和无连接
4.传输速度
5.场景差异
UDP（视频、流媒体、游戏、DNSLookup域名解析）
TCP（SSH，FTP、邮件）

## HTTP
对于同一个域，大多数浏览器会同时建立6个持久连接。

请求行：GET /hello HTTP/1.1
响应行：HTTP/1.1 200 OK

### HTTP/2 协议
1. 是一个二进制协议，分为头信息帧和数据帧，帧的概念是其实现多路复用的基础。

2. 多路复用，在一个连接里，server和client可以同时发送多个请求和响应，不用按照顺序一一发送，这样就避免了“队头阻塞”的问题。

3. 头信息压缩，c和s端同时维护一张头信息表。发送只发送索引号即可。

4. 服务端推送，提前给客户端推送必要的资源，http2主动推送的是静态资源。不同于ws和sse

## HTTPS
使用TLS/SSL来对数据加密。
TLS 握手过程：
1.c向s发起请求，请求包含使用的协议、版本号，生成一个随机数发送到s端。
2.s端收到后确定加密方法，并给出s端证书，生成一个随机数发送到c端。
3.c端确定证书有效后，使用证书中的公钥加密一个随机数发送到s端。
4.服务器使用自己的私钥解密c端发送的随机数。
5.c端和s端根据约定的加密方法使用前面三个随机数，生成对话秘钥，以后的对话过程都使用这个秘钥来加密信息。

非对称加密的方式来对对称加密的秘钥进行传输，然后以后的通信使用对称加密的方式来加密。

## DNS
提供主机名到IP地址的转换服务，就是我们常说的域名系统。


## UDP
报文包括：首部和应用数据。
首部：源端口号、目的端口号、长度和校验和。（8字节）


## TCP
TCP协议是面向连接的，提供可靠数据传输服务。

提供了 点对点、全双工服务，拥有拥塞控制、流量控制机制。

CDN 是一个内容分发网络，向用户提供资源就近访问的功能。
有利于提高网站的访问速度，同时也减轻了源服务器的访问压力。

即时通讯的实现：
1.短轮询，简单易于理解；需要不断地建立HTTP连接，浪费资源
2.长轮询，减少了不必要的HTTP请求；连接挂起也会浪费资源
3.SSE 服务端推送，服务器向客户端发送数据流，例如视频播放，单向通讯
4.websocket
